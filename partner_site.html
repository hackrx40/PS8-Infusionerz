<!DOCTYPE html>
<html>
  <head>
    <!-- Add the website's CSS and other meta tags here -->
    <link
      rel="stylesheet"
      href="https://unpkg.com/purecss@2.0.6/build/pure-min.css"
    />
    <style>

        *{
            overflow-x: hidden;
            margin: 0;
            padding: 0;
        }

        body{
            max-height: 200vh;
        }

        #reactAppContainer{
            display: flex;
            height: 100%;
        }
        
        iframe{
            width: 100%;
            height: 200vh !important;
            height: auto;
            overflow-y: auto;
        }
      /* Dummy Axis Bank Navbar */
      nav {
        background-color: #871F42;
        color: #fff;
        padding: 10px;
        text-align: center;
      }

      /* Dummy Axis Bank Footer */
      footer {
        background-color: #444444;
        color: #fff;
        padding: 10px;
        text-align: center;
        position: fixed;
        bottom: 0;
        width: 100%;
      }

      /* Button to load the React app */
      #loadReactAppButton {
        margin: 20px;
      }

      #loadReactAppButton{
        background-color: #871F42;
        color: #fff;
        padding: 5px;
        border-radius: 5px;
      }
    </style>
  </head>
  <body>
    <!-- Dummy Axis Bank Navbar -->
    <nav>
      <h2><img src="https://application.axisbank.co.in/insurancesite/assets/images/logo-white.png" alt=""></h2>
    </nav>

    <!-- Button to load the React app -->
    <button id="loadReactAppButton">Apply Now</button>

    <!-- Placeholder div for the embedded React app -->
    <div id="reactAppContainer"></div>

    <!-- Dummy Axis Bank Footer -->
    <footer>
      <p>&copy; 2023 Axis Bank. All rights reserved.</p>
    </footer>

    <script>
      document.getElementById('loadReactAppButton').addEventListener('click', function () {
        fetch('http://localhost:8000/get_token')
          .then(response => response.json())
          .then(data => {
            // Check if the received token is valid
            const token = data.token;
            if (token) {
              // Hide the button to prevent re-loading
              document.getElementById('loadReactAppButton').style.display = "none";
              
              // Create the iframe to simulate embedding
              var iframe = document.createElement('iframe');
              iframe.src = 'http://localhost:3000/policy-redirect-page'; // Replace with the actual URL of your React app
              iframe.classList.add('embedded-iframe');
              
              // Append the token in the request headers when loading the React app inside the iframe
              iframe.onload = function() {
                iframe.contentWindow.postMessage({ token }, 'http://localhost:3000');
              };
              
              // Append the iframe to the container div
              var container = document.getElementById('reactAppContainer');
              container.innerHTML = '';
              container.appendChild(iframe);
              iframe.style.height = iframe.contentWindow.document.body.scrollHeight;
            }
          })
          .catch(error => console.error('Error:', error));
      });
    </script>
  </body>
</html>